# I add each file as a dependency of 'all' after I define it as a target.
all:

# Assume all .tex files in this subdirectory are generated by this Makefile
clean:
	rm -f *.tex

# This config may need changing on each machine
ROOT := $(HOME)/code
DB := $(ROOT)/craw-redhat-oss/sqlite/crawl.sqlite
SQLITE3 := sqlite3 -tabs $(DB)

###############################################################
# LaTeX files imported into the main document using \inputgen{}
###############################################################
num-pairs-of-binaries.tex:
	$(SQLITE3) "SELECT count(*) FROM gav_interesting_chosen_paths g1 JOIN gav_interesting_chosen_paths g2 USING (runId, groupId, artifactId, version) WHERE g1.provider < g2.provider AND g1.provider NOT LIKE 'maven.repository.redhat.com/ga%' AND g2.provider NOT LIKE 'maven.repository.redhat.com/ga%' AND 'repo1.maven.org/maven2' IN (g1.provider, g2.provider);" > $@

all: num-pairs-of-binaries.tex

num-jar-pairs-after-invokevirtual-invokeinterface.tex:
	find ../../find-diff-classes/comparisons -name classes.filtered|wc -l > $@

all: num-jar-pairs-after-invokevirtual-invokeinterface.tex

num-jar-pairs-after-invokevirtual-invokeinterface-gaoss.tex:
	find ../../find-diff-classes/comparisons -name classes.filtered|perl -lpe 's|^.*/([^/]+\.vs\.[^/]+)|$$1|' |grep obfs|wc -l > $@

all: num-jar-pairs-after-invokevirtual-invokeinterface-gaoss.tex

num-jar-pairs-after-invokevirtual-invokeinterface-obfs.tex:
	find ../../find-diff-classes/comparisons -name classes.filtered|perl -lpe 's|^.*/([^/]+\.vs\.[^/]+)|$$1|' |grep gaoss|wc -l > $@

all: num-jar-pairs-after-invokevirtual-invokeinterface-obfs.tex

num-class-pairs-after-invokevirtual-invokeinterface.tex:
	find ../../find-diff-classes/comparisons -name classes.filtered|xargs cat|wc -l > $@

all: num-class-pairs-after-invokevirtual-invokeinterface.tex

num-classes-after-invokevirtual-invokeinterface.tex:
	echo TODO > $@

all: num-classes-after-invokevirtual-invokeinterface.tex

num-classes-with-generated-tests.tex:
	echo TODO > $@

all: num-classes-with-generated-tests.tex

num-generated-tests:
	echo TODO > $@

all: num-generated-tests

avg-tests-per-class:
	echo TODO > $@

all: avg-tests-per-class
